/*
 * motor.c
 *
 *  Created on: 2018/04/14
 *      Author: shts
 */
#include "iodefine.h"
#include "motor.h"

MOT r_motor, l_motor;

void init_Motor(void) {
	r_motor.min_acc = 0.0;
	l_motor.min_acc = 0.0;
	r_motor.max_acc = 1e+5;
	l_motor.max_acc = 1e+5;
	r_motor.acc = 0.0;
	l_motor.acc = 0.0;

	r_motor.min_vel = 240.0;
	l_motor.min_vel = 240.0;
	r_motor.max_vel = 2000.0;
	l_motor.max_vel = 2000.0;
	r_motor.vel = 300.0;
	l_motor.vel = 300.0;

	r_motor.cnt = 0.0;
	l_motor.cnt = 0.0;

	r_motor.end_flag = 0.0;
	l_motor.end_flag = 0.0;
	r_motor.stop_flag = 0.0;
	l_motor.stop_flag = 0.0;

	r_motor.rot_dir_flag = 0;
	l_motor.rot_dir_flag = 1;

	r_motor.dist = 0.0;

	PE.DRL.BIT.B2 = 0; //reset (0 : off, 1 : on)
	PE.DRL.BIT.B3 = 0; //excitation_enable (1 : on, 0 : off)

	PE.DRL.BIT.B1 = 0; //R_CW/CCW(0 : forward, 1 : backward)
	PE.DRL.BIT.B5 = 1; //L_CW/CCW(1 : forward, 0 : backward)

	PE.DRL.BIT.B0 = 1; //R_Clock
	PE.DRL.BIT.B4 = 1; //L_Clock

	PE.DRL.BIT.B2 = 0; //reset(0 : off, 1 : on)
	PE.DRL.BIT.B3 = 1; //excitation_enable (1 : on, 0 : off)
}

